import { DEFAULT_INPUT_STATE_NUMBER, DEFAULT_INPUT_STATE_STRING, InputState } from "../../lib/utils/inputBase";
import { useEffect, useState } from "react";

import Button from "@neuralbertatech/react/lib/Button";
import Head from "next/head";
import InputEmail from "@neuralbertatech/react/lib/InputEmail";
import InputNumber from "@neuralbertatech/react/lib/InputNumber";
import InputPassword from "@neuralbertatech/react/lib/InputPassword";
import InputText from "@neuralbertatech/react/lib/InputText";
import type { NextPage } from "next";

interface Form {
  name: InputState<string>;
  email: InputState<string>;
  age: InputState<number>;
}

const Home: NextPage = () => {
  const [name, setName] = useState<InputState<string>>(DEFAULT_INPUT_STATE_STRING);
  const [email, setEmail] = useState<InputState<string>>(DEFAULT_INPUT_STATE_STRING);
  const [password, setPassword] = useState<InputState<string>>(DEFAULT_INPUT_STATE_STRING);
  const [age, setAge] = useState<InputState<number>>(DEFAULT_INPUT_STATE_NUMBER);
  const [form, setForm] = useState<Form>({
    name,
    email,
    age,
  });
  const [disableButton, setDisableButton] = useState(true);

  useEffect(() => {
    const tempForm = {
      name,
      email,
      age,
    };
    setForm(tempForm);
    setDisableButton(Object.values(tempForm)
      .some((value) => value.valid === false));
  }, [name, email, age]);

  return (
    <div>
      <Head>
        <title>Form</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main style={{
        width: "100vw",
        height: "100vh"
      }}>
        <form>
          <label>Name</label>
          <InputText placeholder="Boaty McBoatface" validation={/\w+\s\w+/} state={[name, setName]} />
          <label>Email</label>
          <InputEmail placeholder="example@neuralberta.tech" state={[email, setEmail]} />
          <label>Password</label>
          <InputPassword placeholder="example@neuralberta.tech" state={[password, setPassword]} />
          <label>Age</label>
          <InputNumber placeholder="Email" state={[age, setAge]} min={0} max={5} />
        </form>
        <Button text="Log" onClick={() => console.table(form)} disabled={disableButton} />
      </main>
    </div>
  );
};

export default Home;
